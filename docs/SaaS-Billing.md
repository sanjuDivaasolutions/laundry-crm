TASK OBJECTIVE:
Design a SaaS subscription billing system for tenants while preserving existing Stripe Cashier contract billing.

Focus Areas:
- Stripe product separation strategy
- tenant_subscriptions schema
- Webhook design and idempotency
- Grace period handling
- Failed payment retry logic
- Upgrade / downgrade behavior
- Plan versioning strategy
- Audit and billing reconciliation

DELIVERABLES REQUIRED:
- Database schema
- Stripe product structure
- Webhook flow diagrams
- State machine for subscription lifecycle
- Edge cases
- Security controls
